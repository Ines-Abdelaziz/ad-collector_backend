<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Monitoring Statistics</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">



        {% load static %}

    <!-- Bootstrap CSS
                ============================================ -->
    <link rel="stylesheet" type="text/css" href="{% static 'report-styles/bootstrap.min.css' %}">

    <link rel="stylesheet" href="{% static 'report-styles/bootstrap-table.css' %}">

    <link rel="stylesheet" href="{% static 'report-styles/font-awesome.min.css' %}">

    <link rel="stylesheet" href="{% static 'report-styles/morris.css' %}">


    <link rel="stylesheet" href="{% static 'report-styles/style.css' %}">
    <!-- responsive CSS
                ============================================ -->
    <!-- loader -->
    <style>

        #header-fixed {
	        position: fixed;
   		top: 0px; display:none;
    		background-color:white;
	}

	.loader {
  		border: 16px solid #f3f3f3;
 		border-radius: 50%;
  		border-top: 16px solid #3498db;
  		width: 500px;
  		height: 500px;
		margin : auto;
  		-webkit-animation: spin 2s linear infinite; /* Safari */
  		animation: spin 2s linear infinite;
	}

	/* Safari */
	@-webkit-keyframes spin {
  		0% { -webkit-transform: rotate(0deg); }
  		100% { -webkit-transform: rotate(360deg); }
	}

	@keyframes spin {
  		0% { transform: rotate(0deg); }
  		100% { transform: rotate(360deg); }
	}

      </style>

</head>

<body>
     



	{% include "monitoring/monitoring-header.html" %}

        <div class="advanced-form-area mg-b-15" style="margin-top : 60px;">
            <div class="container-fluid">
                <div class="row">
                        <div class="sparkline10-list mg-tb-30 responsive-mg-t-0 table-mg-t-pro-n dk-res-t-pro-0 nk-ds-n-pro-t-0" style="margin-left: 40px; margin-right: 40px;">
                            <div class="sparkline10-graph">
                                    <div class="row">
                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="chosen-select-single mg-b-20">
                                                <b>
							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                        	<div class="form-select-list">
<!--
                                                                	<select id="select-interval" class="form-control custom-select-value" name="account" style="font-size:20px;">
									<!--	    <option selected disabled hidden>Select the time interval</option> 
									</select>
-->
                                                                </div>
                                                         </div>
                                                </b>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                </div>
            </div>
	</div>
	<div id="loader" class="loader" style="visibility: hidden; display:none;"></div>
	<div id="information-div" style="visibility:hidden; display:none;">

<!--
        <div class="analytics-sparkle-area" style="margin-bottom : 60px;">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="analytics-sparkle-line reso-mg-b-30">
                            <div class="analytics-content">
                                <h5>Total Ads</h5>
                                <h2 style="min-height: 42px;"><span class="counter" id="totalAds"> </span> <span class="tuition-fees">Ad</span> </h2>
                                <span class="text-success" id="adsPercent"></span>
                                <div class="progress m-b-0">
                                    <div class="progress-bar progress-bar-success" role="progressbar" id="adsPercent-bar"></div>  
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="analytics-sparkle-line reso-mg-b-30">
                            <div class="analytics-content">
                                <h5>Total posts from news organisations</h5>
                                <h2 style="min-height: 42px;"><span class="counter" id="totalNews"></span> <span class="tuition-fees">Post</span></h2>
                                <span class="text-success" id="newsPercent"></span>
                                <div class="progress m-b-0">
                                    <div class="progress-bar progress-bar-success" role="progressbar" id="newsPercent-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="analytics-sparkle-line reso-mg-b-30">
                            <div class="analytics-content">
                                <h5>Total public posts</h5>
                                <h2 style="min-height: 42px;"><span class="counter" id="totalPublic"></span> <span class="tuition-fees">Post</span></h2>
                                <span class="text-success" id="publicPercent"></span>
                                <div class="progress m-b-0">
                                    <div class="progress-bar progress-bar-success" role="progressbar" id="publicPercent-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                        <div class="analytics-sparkle-line reso-mg-b-30">
                            <div class="analytics-content">
                                <h5>Total posts</h5>
                                <h2 style="min-height: 42px;"><span class="counter" id="totalPosts"></span> <span class="tuition-fees">Post</span></h2>
                                <span class="text-success" id="postsPercent"></span>
                                <div class="progress m-b-0">
                                    <div class="progress-bar progress-bar-success" role="progressbar" id="postsPercent-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


-->
<!--
       <div class="product-sales-area mg-tb-30">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="product-sales-chart">
                            <div class="portlet-title">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="caption pro-sl-hd">
                                            <span class="caption-subject"><b>Daily active users</b></span>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="actions graph-rp graph-rp-dl">
                                            <p>Since the beginning of the experiment</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ul class="list-inline cus-product-sl-rp">
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #FF0000;"></i>Users</h5>
                                </li>
                            </ul>
                            <div id="active-users-chart" style="height: 356px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

-->

<!--
       <div class="product-sales-area mg-tb-30">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="product-sales-chart">
                            <div class="portlet-title">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="caption pro-sl-hd">
                                            <span class="caption-subject"><b>Daily Statistics</b></span>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="actions graph-rp graph-rp-dl">
                                            <p>Since the beginning of the experiment</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ul class="list-inline cus-product-sl-rp">
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #006DF0;"></i>Ads</h5>
                                </li>
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #933EC5;"></i>News Posts</h5>
                                </li>
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #65b12d;"></i>Public Posts</h5>
                                </li>
                            </ul>
                            <div id="statistics-chart" style="height: 356px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

-->

<!--
     <div class="all-content-wrapper">
        <div class="product-sales-area mg-tb-30">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <div class="product-sales-chart">
                            <div class="portlet-title">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="caption pro-sl-hd">
                                            <span class="caption-subject"><b>Surveys answers</b></span>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                        <div class="actions graph-rp graph-rp-dl">
                                            <p> </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ul class="list-inline cus-product-sl-rp">
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #006DF0;"></i>Number of concerned users</h5>
                                </li>
                                <li>
                                    <h5><i class="fa fa-circle" style="color: #933EC5;"></i>Number of answers</h5>
                                </li>
                            </ul>
                            <div id="morris-bar-chart" style="height: 356px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
-->


        <div class="data-table-area mg-b-15" style="margin-top : 60px;">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="sparkline13-list">
                            <div class="sparkline13-hd">
                                <div class="main-sparkline13-hd">
                                    <h1> Extension <span class="table-project-n">errors</span></h1>
                                </div>
                            </div>
                            <div class="sparkline13-graph">
                                   <table id="table" data-show-export="true" data-toggle="table" class="table table-hover">   
   					<thead>
                                            <tr>
                                                <th data-field="id">ID</th>
                                                <th data-field="date">Date</th>
                                                <th data-field="user-id">User</th>
                                                <th data-field="type">Type</th>
                                                <th data-field="message" >Message</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tableBody">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <!-- Static Table End -->
	</div>


    </div>

    <!-- jquery
		============================================ -->
    <script src="{% static 'report-scripts/jquery-1.12.4.min.js' %}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- bootstrap JS
		============================================ -->
    <script src="{% static 'report-scripts/bootstrap.min.js' %}"></script>

    <script src="{% static 'report-scripts/bootstrap-table.js' %}"></script>
    <script src="{% static 'report-scripts/tableExport.js' %}"></script>
    <script src="{% static 'report-scripts/bootstrap-table-export.js' %}"></script>


    <script src="{% static 'report-scripts/tableExport.js' %}"></script>

    <script src="{% static 'report-scripts/raphael-min.js' %}"></script>

    <script src="{% static 'report-scripts/morris.js' %}"></script>


    <script>


	 function getData(timestamp) {
                $('#information-div').css("visibility", "hidden");
                $('#information-div').css("display", "none");

                $('#loader').css("visibility", "visible");
                $('#loader').css("display", "block");

		sendRequest(timestamp);
	 }

	 function sendRequest(timestamp) {
                $.ajax({
                        type:'POST',
                        url:'get_extension_errors?user='+user,
                        data: {'timestamp':timestamp},
                        success:function(resp){
                                if (resp.status!=='success') {
                                        return
                                }

                                displayTable(resp["errors"]);
                                $('#loader').css("visibility", "hidden");
                                $('#loader').css("display", "none");
                                $('#information-div').css("visibility", "visible");
                                $('#information-div').css("display", "block");

				window.setTimeout(function(){sendRequest(lastTimeStamp);}, 15 * 60 * 1000);
                        }
                })

	 }

	 function displayTable(array) {
                var tbody = document.getElementById("tableBody")
		tbody.innerHTML = '';
		array.forEach(function(element, i) {
			var tdid = document.createElement('td');
			tdid.innerHTML = element.id ;

                        var tddate = document.createElement('td');
                        tddate.innerHTML = element.date;

                        var tduser = document.createElement('td');
                        tduser.innerHTML = element.user_id;

                        var tdtype = document.createElement('td');
                        tdtype.innerHTML = element.action;

                        var tdmessage = document.createElement('td');
                        tdmessage.innerHTML = element.message;


			var tr = document.createElement('tr');
			tr.setAttribute("data-index", i);
			tr.appendChild(tdid);
			tr.appendChild(tddate);
                        tr.appendChild(tduser);
                        tr.appendChild(tdtype);;
			tr.appendChild(tdmessage);

			tbody.appendChild(tr);
		})
	 }

	function timeConverter(UNIX_timestamp){
		if(UNIX_timestamp == 0) return "" 
  		var a = new Date(UNIX_timestamp);
  		var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  		var year = a.getFullYear();
  		var month = months[a.getMonth()];
  		var date = a.getDate();
  		var hour = a.getHours();
  		var min = a.getMinutes();
  		var sec = a.getSeconds();
  		var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec ;
  		return time;
	}



//	$("#select-interval").val($("#select-interval option:first").val());
//	lastTimeStamp = $("#select-interval").val();

        var date = new Date();
        date.setHours(0,0,0,0);
	lastTimeStamp = date.getTime()
	getData(lastTimeStamp);
	
    </script>
</body>

</html>
